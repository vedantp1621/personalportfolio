{"ast":null,"code":"import Node, { addNodeClass } from '../core/Node.js';\nimport { attribute } from '../core/AttributeNode.js';\nimport { temp } from '../core/VarNode.js';\nimport { varying } from '../core/VaryingNode.js';\nimport { normalize } from '../math/MathNode.js';\nimport { cameraViewMatrix } from './CameraNode.js';\nimport { modelViewMatrix } from './ModelNode.js';\nimport { nodeImmutable } from '../shadernode/ShaderNode.js';\nclass TangentNode extends Node {\n  constructor() {\n    let scope = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : TangentNode.LOCAL;\n    super();\n    this.scope = scope;\n  }\n  getHash( /*builder*/\n  ) {\n    return `tangent-${this.scope}`;\n  }\n  getNodeType() {\n    const scope = this.scope;\n    if (scope === TangentNode.GEOMETRY) {\n      return 'vec4';\n    }\n    return 'vec3';\n  }\n  generate(builder) {\n    const scope = this.scope;\n    let outputNode = null;\n    if (scope === TangentNode.GEOMETRY) {\n      outputNode = attribute('tangent', 'vec4');\n    } else if (scope === TangentNode.LOCAL) {\n      outputNode = varying(tangentGeometry.xyz);\n    } else if (scope === TangentNode.VIEW) {\n      const vertexNode = modelViewMatrix.mul(tangentLocal).xyz;\n      outputNode = normalize(varying(vertexNode));\n    } else if (scope === TangentNode.WORLD) {\n      const vertexNode = tangentView.transformDirection(cameraViewMatrix);\n      outputNode = normalize(varying(vertexNode));\n    }\n    return outputNode.build(builder, this.getNodeType(builder));\n  }\n  serialize(data) {\n    super.serialize(data);\n    data.scope = this.scope;\n  }\n  deserialize(data) {\n    super.deserialize(data);\n    this.scope = data.scope;\n  }\n}\nTangentNode.GEOMETRY = 'geometry';\nTangentNode.LOCAL = 'local';\nTangentNode.VIEW = 'view';\nTangentNode.WORLD = 'world';\nexport default TangentNode;\nexport const tangentGeometry = nodeImmutable(TangentNode, TangentNode.GEOMETRY);\nexport const tangentLocal = nodeImmutable(TangentNode, TangentNode.LOCAL);\nexport const tangentView = nodeImmutable(TangentNode, TangentNode.VIEW);\nexport const tangentWorld = nodeImmutable(TangentNode, TangentNode.WORLD);\nexport const transformedTangentView = temp(tangentView, 'TransformedTangentView');\nexport const transformedTangentWorld = normalize(transformedTangentView.transformDirection(cameraViewMatrix));\naddNodeClass('TangentNode', TangentNode);","map":{"version":3,"names":["Node","addNodeClass","attribute","temp","varying","normalize","cameraViewMatrix","modelViewMatrix","nodeImmutable","TangentNode","constructor","scope","arguments","length","undefined","LOCAL","getHash","getNodeType","GEOMETRY","generate","builder","outputNode","tangentGeometry","xyz","VIEW","vertexNode","mul","tangentLocal","WORLD","tangentView","transformDirection","build","serialize","data","deserialize","tangentWorld","transformedTangentView","transformedTangentWorld"],"sources":["/Users/vedant/node_modules/three/examples/jsm/nodes/accessors/TangentNode.js"],"sourcesContent":["import Node, { addNodeClass } from '../core/Node.js';\nimport { attribute } from '../core/AttributeNode.js';\nimport { temp } from '../core/VarNode.js';\nimport { varying } from '../core/VaryingNode.js';\nimport { normalize } from '../math/MathNode.js';\nimport { cameraViewMatrix } from './CameraNode.js';\nimport { modelViewMatrix } from './ModelNode.js';\nimport { nodeImmutable } from '../shadernode/ShaderNode.js';\n\nclass TangentNode extends Node {\n\n\tconstructor( scope = TangentNode.LOCAL ) {\n\n\t\tsuper();\n\n\t\tthis.scope = scope;\n\n\t}\n\n\tgetHash( /*builder*/ ) {\n\n\t\treturn `tangent-${this.scope}`;\n\n\t}\n\n\tgetNodeType() {\n\n\t\tconst scope = this.scope;\n\n\t\tif ( scope === TangentNode.GEOMETRY ) {\n\n\t\t\treturn 'vec4';\n\n\t\t}\n\n\t\treturn 'vec3';\n\n\t}\n\n\n\tgenerate( builder ) {\n\n\t\tconst scope = this.scope;\n\n\t\tlet outputNode = null;\n\n\t\tif ( scope === TangentNode.GEOMETRY ) {\n\n\t\t\toutputNode = attribute( 'tangent', 'vec4' );\n\n\t\t} else if ( scope === TangentNode.LOCAL ) {\n\n\t\t\toutputNode = varying( tangentGeometry.xyz );\n\n\t\t} else if ( scope === TangentNode.VIEW ) {\n\n\t\t\tconst vertexNode = modelViewMatrix.mul( tangentLocal ).xyz;\n\t\t\toutputNode = normalize( varying( vertexNode ) );\n\n\t\t} else if ( scope === TangentNode.WORLD ) {\n\n\t\t\tconst vertexNode = tangentView.transformDirection( cameraViewMatrix );\n\t\t\toutputNode = normalize( varying( vertexNode ) );\n\n\t\t}\n\n\t\treturn outputNode.build( builder, this.getNodeType( builder ) );\n\n\t}\n\n\tserialize( data ) {\n\n\t\tsuper.serialize( data );\n\n\t\tdata.scope = this.scope;\n\n\t}\n\n\tdeserialize( data ) {\n\n\t\tsuper.deserialize( data );\n\n\t\tthis.scope = data.scope;\n\n\t}\n\n}\n\nTangentNode.GEOMETRY = 'geometry';\nTangentNode.LOCAL = 'local';\nTangentNode.VIEW = 'view';\nTangentNode.WORLD = 'world';\n\nexport default TangentNode;\n\nexport const tangentGeometry = nodeImmutable( TangentNode, TangentNode.GEOMETRY );\nexport const tangentLocal = nodeImmutable( TangentNode, TangentNode.LOCAL );\nexport const tangentView = nodeImmutable( TangentNode, TangentNode.VIEW );\nexport const tangentWorld = nodeImmutable( TangentNode, TangentNode.WORLD );\nexport const transformedTangentView = temp( tangentView, 'TransformedTangentView' );\nexport const transformedTangentWorld = normalize( transformedTangentView.transformDirection( cameraViewMatrix ) );\n\naddNodeClass( 'TangentNode', TangentNode );\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}