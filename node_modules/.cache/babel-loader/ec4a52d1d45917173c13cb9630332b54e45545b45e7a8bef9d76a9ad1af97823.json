{"ast":null,"code":"import _classCallCheck from \"/Users/vedant/Documents/GitHub/vedantpPersWebsite/node_modules/@babel/runtime/helpers/esm/classCallCheck.js\";\nimport _createClass from \"/Users/vedant/Documents/GitHub/vedantpPersWebsite/node_modules/@babel/runtime/helpers/esm/createClass.js\";\nimport _get from \"/Users/vedant/Documents/GitHub/vedantpPersWebsite/node_modules/@babel/runtime/helpers/esm/get.js\";\nimport _getPrototypeOf from \"/Users/vedant/Documents/GitHub/vedantpPersWebsite/node_modules/@babel/runtime/helpers/esm/getPrototypeOf.js\";\nimport _inherits from \"/Users/vedant/Documents/GitHub/vedantpPersWebsite/node_modules/@babel/runtime/helpers/esm/inherits.js\";\nimport _createSuper from \"/Users/vedant/Documents/GitHub/vedantpPersWebsite/node_modules/@babel/runtime/helpers/esm/createSuper.js\";\nimport Node, { addNodeClass } from '../core/Node.js';\nimport { nodeImmutable, nodeProxy } from '../shadernode/ShaderNode.js';\nimport { cameraNear, cameraFar } from '../accessors/CameraNode.js';\nimport { positionView } from '../accessors/PositionNode.js';\nimport { viewportDepthTexture } from './ViewportDepthTextureNode.js';\nvar ViewportDepthNode = /*#__PURE__*/function (_Node) {\n  _inherits(ViewportDepthNode, _Node);\n  var _super = _createSuper(ViewportDepthNode);\n  function ViewportDepthNode(scope) {\n    var _this;\n    var valueNode = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : null;\n    _classCallCheck(this, ViewportDepthNode);\n    _this = _super.call(this, 'float');\n    _this.scope = scope;\n    _this.valueNode = valueNode;\n    _this.isViewportDepthNode = true;\n    return _this;\n  }\n  _createClass(ViewportDepthNode, [{\n    key: \"generate\",\n    value: function generate(builder) {\n      var scope = this.scope;\n      if (scope === ViewportDepthNode.DEPTH_PIXEL) {\n        return builder.getFragDepth();\n      }\n      return _get(_getPrototypeOf(ViewportDepthNode.prototype), \"generate\", this).call(this, builder);\n    }\n  }, {\n    key: \"setup\",\n    value: function setup( /*builder*/\n    ) {\n      var scope = this.scope;\n      var node = null;\n      if (scope === ViewportDepthNode.DEPTH) {\n        node = viewZToOrthographicDepth(positionView.z, cameraNear, cameraFar);\n      } else if (scope === ViewportDepthNode.DEPTH_TEXTURE) {\n        var texture = this.valueNode || viewportDepthTexture();\n        var viewZ = perspectiveDepthToViewZ(texture, cameraNear, cameraFar);\n        node = viewZToOrthographicDepth(viewZ, cameraNear, cameraFar);\n      } else if (scope === ViewportDepthNode.DEPTH_PIXEL) {\n        if (this.valueNode !== null) {\n          node = depthPixelBase().assign(this.valueNode);\n        }\n      }\n      return node;\n    }\n  }]);\n  return ViewportDepthNode;\n}(Node); // NOTE: viewZ, the z-coordinate in camera space, is negative for points in front of the camera\n// -near maps to 0; -far maps to 1\nexport var viewZToOrthographicDepth = function viewZToOrthographicDepth(viewZ, near, far) {\n  return viewZ.add(near).div(near.sub(far));\n};\n\n// maps orthographic depth in [ 0, 1 ] to viewZ\nexport var orthographicDepthToViewZ = function orthographicDepthToViewZ(depth, near, far) {\n  return near.sub(far).mul(depth).sub(near);\n};\n\n// NOTE: https://twitter.com/gonnavis/status/1377183786949959682\n\n// -near maps to 0; -far maps to 1\nexport var viewZToPerspectiveDepth = function viewZToPerspectiveDepth(viewZ, near, far) {\n  return near.add(viewZ).mul(far).div(near.sub(far).mul(viewZ));\n};\n\n// maps perspective depth in [ 0, 1 ] to viewZ\nexport var perspectiveDepthToViewZ = function perspectiveDepthToViewZ(depth, near, far) {\n  return near.mul(far).div(far.sub(near).mul(depth).sub(far));\n};\nViewportDepthNode.DEPTH = 'depth';\nViewportDepthNode.DEPTH_TEXTURE = 'depthTexture';\nViewportDepthNode.DEPTH_PIXEL = 'depthPixel';\nexport default ViewportDepthNode;\nvar depthPixelBase = nodeProxy(ViewportDepthNode, ViewportDepthNode.DEPTH_PIXEL);\nexport var depth = nodeImmutable(ViewportDepthNode, ViewportDepthNode.DEPTH);\nexport var depthTexture = nodeProxy(ViewportDepthNode, ViewportDepthNode.DEPTH_TEXTURE);\nexport var depthPixel = nodeImmutable(ViewportDepthNode, ViewportDepthNode.DEPTH_PIXEL);\ndepthPixel.assign = function (value) {\n  return depthPixelBase(value);\n};\naddNodeClass('ViewportDepthNode', ViewportDepthNode);","map":{"version":3,"names":["Node","addNodeClass","nodeImmutable","nodeProxy","cameraNear","cameraFar","positionView","viewportDepthTexture","ViewportDepthNode","_Node","_inherits","_super","_createSuper","scope","_this","valueNode","arguments","length","undefined","_classCallCheck","call","isViewportDepthNode","_createClass","key","value","generate","builder","DEPTH_PIXEL","getFragDepth","_get","_getPrototypeOf","prototype","setup","node","DEPTH","viewZToOrthographicDepth","z","DEPTH_TEXTURE","texture","viewZ","perspectiveDepthToViewZ","depthPixelBase","assign","near","far","add","div","sub","orthographicDepthToViewZ","depth","mul","viewZToPerspectiveDepth","depthTexture","depthPixel"],"sources":["/Users/vedant/node_modules/three/examples/jsm/nodes/display/ViewportDepthNode.js"],"sourcesContent":["import Node, { addNodeClass } from '../core/Node.js';\nimport { nodeImmutable, nodeProxy } from '../shadernode/ShaderNode.js';\nimport { cameraNear, cameraFar } from '../accessors/CameraNode.js';\nimport { positionView } from '../accessors/PositionNode.js';\nimport { viewportDepthTexture } from './ViewportDepthTextureNode.js';\n\nclass ViewportDepthNode extends Node {\n\n\tconstructor( scope, valueNode = null ) {\n\n\t\tsuper( 'float' );\n\n\t\tthis.scope = scope;\n\t\tthis.valueNode = valueNode;\n\n\t\tthis.isViewportDepthNode = true;\n\n\t}\n\n\tgenerate( builder ) {\n\n\t\tconst { scope } = this;\n\n\t\tif ( scope === ViewportDepthNode.DEPTH_PIXEL ) {\n\n\t\t\treturn builder.getFragDepth();\n\n\t\t}\n\n\t\treturn super.generate( builder );\n\n\t}\n\n\tsetup( /*builder*/ ) {\n\n\t\tconst { scope } = this;\n\n\t\tlet node = null;\n\n\t\tif ( scope === ViewportDepthNode.DEPTH ) {\n\n\t\t\tnode = viewZToOrthographicDepth( positionView.z, cameraNear, cameraFar );\n\n\t\t} else if ( scope === ViewportDepthNode.DEPTH_TEXTURE ) {\n\n\t\t\tconst texture = this.valueNode || viewportDepthTexture();\n\n\t\t\tconst viewZ = perspectiveDepthToViewZ( texture, cameraNear, cameraFar );\n\t\t\tnode = viewZToOrthographicDepth( viewZ, cameraNear, cameraFar );\n\n\t\t} else if ( scope === ViewportDepthNode.DEPTH_PIXEL ) {\n\n\t\t\tif ( this.valueNode !== null ) {\n\n \t\t\t\tnode = depthPixelBase().assign( this.valueNode );\n\n\t\t\t}\n\n\t\t}\n\n\t\treturn node;\n\n\t}\n\n}\n\n// NOTE: viewZ, the z-coordinate in camera space, is negative for points in front of the camera\n\n// -near maps to 0; -far maps to 1\nexport const viewZToOrthographicDepth = ( viewZ, near, far ) => viewZ.add( near ).div( near.sub( far ) );\n\n// maps orthographic depth in [ 0, 1 ] to viewZ\nexport const orthographicDepthToViewZ = ( depth, near, far ) => near.sub( far ).mul( depth ).sub( near );\n\n// NOTE: https://twitter.com/gonnavis/status/1377183786949959682\n\n// -near maps to 0; -far maps to 1\nexport const viewZToPerspectiveDepth = ( viewZ, near, far ) => near.add( viewZ ).mul( far ).div( near.sub( far ).mul( viewZ ) );\n\n// maps perspective depth in [ 0, 1 ] to viewZ\nexport const perspectiveDepthToViewZ = ( depth, near, far ) => near.mul( far ).div( far.sub( near ).mul( depth ).sub( far ) );\n\nViewportDepthNode.DEPTH = 'depth';\nViewportDepthNode.DEPTH_TEXTURE = 'depthTexture';\nViewportDepthNode.DEPTH_PIXEL = 'depthPixel';\n\nexport default ViewportDepthNode;\n\nconst depthPixelBase = nodeProxy( ViewportDepthNode, ViewportDepthNode.DEPTH_PIXEL );\n\nexport const depth = nodeImmutable( ViewportDepthNode, ViewportDepthNode.DEPTH );\nexport const depthTexture = nodeProxy( ViewportDepthNode, ViewportDepthNode.DEPTH_TEXTURE );\nexport const depthPixel = nodeImmutable( ViewportDepthNode, ViewportDepthNode.DEPTH_PIXEL );\n\ndepthPixel.assign = ( value ) => depthPixelBase( value );\n\naddNodeClass( 'ViewportDepthNode', ViewportDepthNode );\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}