{"ast":null,"code":"import UniformNode from '../core/UniformNode.js';\nimport { NodeUpdateType } from '../core/constants.js';\nimport { nodeObject, nodeImmutable } from '../shadernode/ShaderNode.js';\nimport { addNodeClass } from '../core/Node.js';\nclass TimerNode extends UniformNode {\n  constructor() {\n    let scope = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : TimerNode.LOCAL;\n    let scale = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 1;\n    let value = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : 0;\n    super(value);\n    this.scope = scope;\n    this.scale = scale;\n    this.updateType = NodeUpdateType.FRAME;\n  }\n  /*\n  @TODO:\n  getNodeType( builder ) {\n  \t\tconst scope = this.scope;\n  \t\tif ( scope === TimerNode.FRAME ) {\n  \t\t\treturn 'uint';\n  \t\t}\n  \t\treturn 'float';\n  \t}\n  */\n  update(frame) {\n    const scope = this.scope;\n    const scale = this.scale;\n    if (scope === TimerNode.LOCAL) {\n      this.value += frame.deltaTime * scale;\n    } else if (scope === TimerNode.DELTA) {\n      this.value = frame.deltaTime * scale;\n    } else if (scope === TimerNode.FRAME) {\n      this.value = frame.frameId;\n    } else {\n      // global\n\n      this.value = frame.time * scale;\n    }\n  }\n  serialize(data) {\n    super.serialize(data);\n    data.scope = this.scope;\n    data.scale = this.scale;\n  }\n  deserialize(data) {\n    super.deserialize(data);\n    this.scope = data.scope;\n    this.scale = data.scale;\n  }\n}\nTimerNode.LOCAL = 'local';\nTimerNode.GLOBAL = 'global';\nTimerNode.DELTA = 'delta';\nTimerNode.FRAME = 'frame';\nexport default TimerNode;\n\n// @TODO: add support to use node in timeScale\nexport const timerLocal = function (timeScale) {\n  let value = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 0;\n  return nodeObject(new TimerNode(TimerNode.LOCAL, timeScale, value));\n};\nexport const timerGlobal = function (timeScale) {\n  let value = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 0;\n  return nodeObject(new TimerNode(TimerNode.GLOBAL, timeScale, value));\n};\nexport const timerDelta = function (timeScale) {\n  let value = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 0;\n  return nodeObject(new TimerNode(TimerNode.DELTA, timeScale, value));\n};\nexport const frameId = nodeImmutable(TimerNode, TimerNode.FRAME).uint();\naddNodeClass('TimerNode', TimerNode);","map":{"version":3,"names":["UniformNode","NodeUpdateType","nodeObject","nodeImmutable","addNodeClass","TimerNode","constructor","scope","arguments","length","undefined","LOCAL","scale","value","updateType","FRAME","update","frame","deltaTime","DELTA","frameId","time","serialize","data","deserialize","GLOBAL","timerLocal","timeScale","timerGlobal","timerDelta","uint"],"sources":["/Users/vedant/node_modules/three/examples/jsm/nodes/utils/TimerNode.js"],"sourcesContent":["import UniformNode from '../core/UniformNode.js';\nimport { NodeUpdateType } from '../core/constants.js';\nimport { nodeObject, nodeImmutable } from '../shadernode/ShaderNode.js';\nimport { addNodeClass } from '../core/Node.js';\n\nclass TimerNode extends UniformNode {\n\n\tconstructor( scope = TimerNode.LOCAL, scale = 1, value = 0 ) {\n\n\t\tsuper( value );\n\n\t\tthis.scope = scope;\n\t\tthis.scale = scale;\n\n\t\tthis.updateType = NodeUpdateType.FRAME;\n\n\t}\n\t/*\n\t@TODO:\n\tgetNodeType( builder ) {\n\n\t\tconst scope = this.scope;\n\n\t\tif ( scope === TimerNode.FRAME ) {\n\n\t\t\treturn 'uint';\n\n\t\t}\n\n\t\treturn 'float';\n\n\t}\n*/\n\tupdate( frame ) {\n\n\t\tconst scope = this.scope;\n\t\tconst scale = this.scale;\n\n\t\tif ( scope === TimerNode.LOCAL ) {\n\n\t\t\tthis.value += frame.deltaTime * scale;\n\n\t\t} else if ( scope === TimerNode.DELTA ) {\n\n\t\t\tthis.value = frame.deltaTime * scale;\n\n\t\t} else if ( scope === TimerNode.FRAME ) {\n\n\t\t\tthis.value = frame.frameId;\n\n\t\t} else {\n\n\t\t\t// global\n\n\t\t\tthis.value = frame.time * scale;\n\n\t\t}\n\n\t}\n\n\tserialize( data ) {\n\n\t\tsuper.serialize( data );\n\n\t\tdata.scope = this.scope;\n\t\tdata.scale = this.scale;\n\n\t}\n\n\tdeserialize( data ) {\n\n\t\tsuper.deserialize( data );\n\n\t\tthis.scope = data.scope;\n\t\tthis.scale = data.scale;\n\n\t}\n\n}\n\nTimerNode.LOCAL = 'local';\nTimerNode.GLOBAL = 'global';\nTimerNode.DELTA = 'delta';\nTimerNode.FRAME = 'frame';\n\nexport default TimerNode;\n\n// @TODO: add support to use node in timeScale\nexport const timerLocal = ( timeScale, value = 0 ) => nodeObject( new TimerNode( TimerNode.LOCAL, timeScale, value ) );\nexport const timerGlobal = ( timeScale, value = 0 ) => nodeObject( new TimerNode( TimerNode.GLOBAL, timeScale, value ) );\nexport const timerDelta = ( timeScale, value = 0 ) => nodeObject( new TimerNode( TimerNode.DELTA, timeScale, value ) );\nexport const frameId = nodeImmutable( TimerNode, TimerNode.FRAME ).uint();\n\naddNodeClass( 'TimerNode', TimerNode );\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}