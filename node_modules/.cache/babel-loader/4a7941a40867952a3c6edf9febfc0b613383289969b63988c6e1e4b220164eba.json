{"ast":null,"code":"import TextureNode from '../accessors/TextureNode.js';\nimport { NodeUpdateType } from '../core/constants.js';\nimport { addNodeClass } from '../core/Node.js';\nimport { addNodeElement, nodeProxy } from '../shadernode/ShaderNode.js';\nimport { viewportTopLeft } from './ViewportNode.js';\nimport { Vector2, FramebufferTexture, LinearMipmapLinearFilter } from 'three';\nconst _size = new Vector2();\nclass ViewportTextureNode extends TextureNode {\n  constructor() {\n    let uvNode = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : viewportTopLeft;\n    let levelNode = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : null;\n    let framebufferTexture = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : null;\n    if (framebufferTexture === null) {\n      framebufferTexture = new FramebufferTexture();\n      framebufferTexture.minFilter = LinearMipmapLinearFilter;\n    }\n    super(framebufferTexture, uvNode, levelNode);\n    this.generateMipmaps = false;\n    this.isOutputTextureNode = true;\n    this.updateBeforeType = NodeUpdateType.FRAME;\n  }\n  updateBefore(frame) {\n    const renderer = frame.renderer;\n    renderer.getDrawingBufferSize(_size);\n\n    //\n\n    const framebufferTexture = this.value;\n    if (framebufferTexture.image.width !== _size.width || framebufferTexture.image.height !== _size.height) {\n      framebufferTexture.image.width = _size.width;\n      framebufferTexture.image.height = _size.height;\n      framebufferTexture.needsUpdate = true;\n    }\n\n    //\n\n    const currentGenerateMipmaps = framebufferTexture.generateMipmaps;\n    framebufferTexture.generateMipmaps = this.generateMipmaps;\n    renderer.copyFramebufferToTexture(framebufferTexture);\n    framebufferTexture.generateMipmaps = currentGenerateMipmaps;\n  }\n  clone() {\n    return new this.constructor(this.uvNode, this.levelNode, this.value);\n  }\n}\nexport default ViewportTextureNode;\nexport const viewportTexture = nodeProxy(ViewportTextureNode);\nexport const viewportMipTexture = nodeProxy(ViewportTextureNode, null, null, {\n  generateMipmaps: true\n});\naddNodeElement('viewportTexture', viewportTexture);\naddNodeElement('viewportMipTexture', viewportMipTexture);\naddNodeClass('ViewportTextureNode', ViewportTextureNode);","map":{"version":3,"names":["TextureNode","NodeUpdateType","addNodeClass","addNodeElement","nodeProxy","viewportTopLeft","Vector2","FramebufferTexture","LinearMipmapLinearFilter","_size","ViewportTextureNode","constructor","uvNode","arguments","length","undefined","levelNode","framebufferTexture","minFilter","generateMipmaps","isOutputTextureNode","updateBeforeType","FRAME","updateBefore","frame","renderer","getDrawingBufferSize","value","image","width","height","needsUpdate","currentGenerateMipmaps","copyFramebufferToTexture","clone","viewportTexture","viewportMipTexture"],"sources":["/Users/vedant/node_modules/three/examples/jsm/nodes/display/ViewportTextureNode.js"],"sourcesContent":["import TextureNode from '../accessors/TextureNode.js';\nimport { NodeUpdateType } from '../core/constants.js';\nimport { addNodeClass } from '../core/Node.js';\nimport { addNodeElement, nodeProxy } from '../shadernode/ShaderNode.js';\nimport { viewportTopLeft } from './ViewportNode.js';\nimport { Vector2, FramebufferTexture, LinearMipmapLinearFilter } from 'three';\n\nconst _size = new Vector2();\n\nclass ViewportTextureNode extends TextureNode {\n\n\tconstructor( uvNode = viewportTopLeft, levelNode = null, framebufferTexture = null ) {\n\n\t\tif ( framebufferTexture === null ) {\n\n\t\t\tframebufferTexture = new FramebufferTexture();\n\t\t\tframebufferTexture.minFilter = LinearMipmapLinearFilter;\n\n\t\t}\n\n\t\tsuper( framebufferTexture, uvNode, levelNode );\n\n\t\tthis.generateMipmaps = false;\n\n\t\tthis.isOutputTextureNode = true;\n\n\t\tthis.updateBeforeType = NodeUpdateType.FRAME;\n\n\t}\n\n\tupdateBefore( frame ) {\n\n\t\tconst renderer = frame.renderer;\n\t\trenderer.getDrawingBufferSize( _size );\n\n\t\t//\n\n\t\tconst framebufferTexture = this.value;\n\n\t\tif ( framebufferTexture.image.width !== _size.width || framebufferTexture.image.height !== _size.height ) {\n\n\t\t\tframebufferTexture.image.width = _size.width;\n\t\t\tframebufferTexture.image.height = _size.height;\n\t\t\tframebufferTexture.needsUpdate = true;\n\n\t\t}\n\n\t\t//\n\n\t\tconst currentGenerateMipmaps = framebufferTexture.generateMipmaps;\n\t\tframebufferTexture.generateMipmaps = this.generateMipmaps;\n\n\t\trenderer.copyFramebufferToTexture( framebufferTexture );\n\n\t\tframebufferTexture.generateMipmaps = currentGenerateMipmaps;\n\n\t}\n\n\tclone() {\n\n\t\treturn new this.constructor( this.uvNode, this.levelNode, this.value );\n\n\t}\n\n}\n\nexport default ViewportTextureNode;\n\nexport const viewportTexture = nodeProxy( ViewportTextureNode );\nexport const viewportMipTexture = nodeProxy( ViewportTextureNode, null, null, { generateMipmaps: true } );\n\naddNodeElement( 'viewportTexture', viewportTexture );\naddNodeElement( 'viewportMipTexture', viewportMipTexture );\n\naddNodeClass( 'ViewportTextureNode', ViewportTextureNode );\n"],"mappings":"AAAA,OAAOA,WAAW,MAAM,6BAA6B;AACrD,SAASC,cAAc,QAAQ,sBAAsB;AACrD,SAASC,YAAY,QAAQ,iBAAiB;AAC9C,SAASC,cAAc,EAAEC,SAAS,QAAQ,6BAA6B;AACvE,SAASC,eAAe,QAAQ,mBAAmB;AACnD,SAASC,OAAO,EAAEC,kBAAkB,EAAEC,wBAAwB,QAAQ,OAAO;AAE7E,MAAMC,KAAK,GAAG,IAAIH,OAAO,CAAC,CAAC;AAE3B,MAAMI,mBAAmB,SAASV,WAAW,CAAC;EAE7CW,WAAWA,CAAA,EAA0E;IAAA,IAAxEC,MAAM,GAAAC,SAAA,CAAAC,MAAA,QAAAD,SAAA,QAAAE,SAAA,GAAAF,SAAA,MAAGR,eAAe;IAAA,IAAEW,SAAS,GAAAH,SAAA,CAAAC,MAAA,QAAAD,SAAA,QAAAE,SAAA,GAAAF,SAAA,MAAG,IAAI;IAAA,IAAEI,kBAAkB,GAAAJ,SAAA,CAAAC,MAAA,QAAAD,SAAA,QAAAE,SAAA,GAAAF,SAAA,MAAG,IAAI;IAEjF,IAAKI,kBAAkB,KAAK,IAAI,EAAG;MAElCA,kBAAkB,GAAG,IAAIV,kBAAkB,CAAC,CAAC;MAC7CU,kBAAkB,CAACC,SAAS,GAAGV,wBAAwB;IAExD;IAEA,KAAK,CAAES,kBAAkB,EAAEL,MAAM,EAAEI,SAAU,CAAC;IAE9C,IAAI,CAACG,eAAe,GAAG,KAAK;IAE5B,IAAI,CAACC,mBAAmB,GAAG,IAAI;IAE/B,IAAI,CAACC,gBAAgB,GAAGpB,cAAc,CAACqB,KAAK;EAE7C;EAEAC,YAAYA,CAAEC,KAAK,EAAG;IAErB,MAAMC,QAAQ,GAAGD,KAAK,CAACC,QAAQ;IAC/BA,QAAQ,CAACC,oBAAoB,CAAEjB,KAAM,CAAC;;IAEtC;;IAEA,MAAMQ,kBAAkB,GAAG,IAAI,CAACU,KAAK;IAErC,IAAKV,kBAAkB,CAACW,KAAK,CAACC,KAAK,KAAKpB,KAAK,CAACoB,KAAK,IAAIZ,kBAAkB,CAACW,KAAK,CAACE,MAAM,KAAKrB,KAAK,CAACqB,MAAM,EAAG;MAEzGb,kBAAkB,CAACW,KAAK,CAACC,KAAK,GAAGpB,KAAK,CAACoB,KAAK;MAC5CZ,kBAAkB,CAACW,KAAK,CAACE,MAAM,GAAGrB,KAAK,CAACqB,MAAM;MAC9Cb,kBAAkB,CAACc,WAAW,GAAG,IAAI;IAEtC;;IAEA;;IAEA,MAAMC,sBAAsB,GAAGf,kBAAkB,CAACE,eAAe;IACjEF,kBAAkB,CAACE,eAAe,GAAG,IAAI,CAACA,eAAe;IAEzDM,QAAQ,CAACQ,wBAAwB,CAAEhB,kBAAmB,CAAC;IAEvDA,kBAAkB,CAACE,eAAe,GAAGa,sBAAsB;EAE5D;EAEAE,KAAKA,CAAA,EAAG;IAEP,OAAO,IAAI,IAAI,CAACvB,WAAW,CAAE,IAAI,CAACC,MAAM,EAAE,IAAI,CAACI,SAAS,EAAE,IAAI,CAACW,KAAM,CAAC;EAEvE;AAED;AAEA,eAAejB,mBAAmB;AAElC,OAAO,MAAMyB,eAAe,GAAG/B,SAAS,CAAEM,mBAAoB,CAAC;AAC/D,OAAO,MAAM0B,kBAAkB,GAAGhC,SAAS,CAAEM,mBAAmB,EAAE,IAAI,EAAE,IAAI,EAAE;EAAES,eAAe,EAAE;AAAK,CAAE,CAAC;AAEzGhB,cAAc,CAAE,iBAAiB,EAAEgC,eAAgB,CAAC;AACpDhC,cAAc,CAAE,oBAAoB,EAAEiC,kBAAmB,CAAC;AAE1DlC,YAAY,CAAE,qBAAqB,EAAEQ,mBAAoB,CAAC"},"metadata":{},"sourceType":"module","externalDependencies":[]}