{"ast":null,"code":"import Node, { addNodeClass } from '../core/Node.js';\nimport { NodeUpdateType } from '../core/constants.js';\nimport UniformNode from '../core/UniformNode.js';\nimport { nodeProxy } from '../shadernode/ShaderNode.js';\nimport { Vector3 } from 'three';\nclass Object3DNode extends Node {\n  constructor() {\n    let scope = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : Object3DNode.VIEW_MATRIX;\n    let object3d = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : null;\n    super();\n    this.scope = scope;\n    this.object3d = object3d;\n    this.updateType = NodeUpdateType.OBJECT;\n    this._uniformNode = new UniformNode(null);\n  }\n  getNodeType() {\n    const scope = this.scope;\n    if (scope === Object3DNode.WORLD_MATRIX || scope === Object3DNode.VIEW_MATRIX) {\n      return 'mat4';\n    } else if (scope === Object3DNode.NORMAL_MATRIX) {\n      return 'mat3';\n    } else if (scope === Object3DNode.POSITION || scope === Object3DNode.VIEW_POSITION || scope === Object3DNode.DIRECTION || scope === Object3DNode.SCALE) {\n      return 'vec3';\n    }\n  }\n  update(frame) {\n    const object = this.object3d;\n    const uniformNode = this._uniformNode;\n    const scope = this.scope;\n    if (scope === Object3DNode.VIEW_MATRIX) {\n      uniformNode.value = object.modelViewMatrix;\n    } else if (scope === Object3DNode.NORMAL_MATRIX) {\n      uniformNode.value = object.normalMatrix;\n    } else if (scope === Object3DNode.WORLD_MATRIX) {\n      uniformNode.value = object.matrixWorld;\n    } else if (scope === Object3DNode.POSITION) {\n      uniformNode.value = uniformNode.value || new Vector3();\n      uniformNode.value.setFromMatrixPosition(object.matrixWorld);\n    } else if (scope === Object3DNode.SCALE) {\n      uniformNode.value = uniformNode.value || new Vector3();\n      uniformNode.value.setFromMatrixScale(object.matrixWorld);\n    } else if (scope === Object3DNode.DIRECTION) {\n      uniformNode.value = uniformNode.value || new Vector3();\n      object.getWorldDirection(uniformNode.value);\n    } else if (scope === Object3DNode.VIEW_POSITION) {\n      const camera = frame.camera;\n      uniformNode.value = uniformNode.value || new Vector3();\n      uniformNode.value.setFromMatrixPosition(object.matrixWorld);\n      uniformNode.value.applyMatrix4(camera.matrixWorldInverse);\n    }\n  }\n  generate(builder) {\n    const scope = this.scope;\n    if (scope === Object3DNode.WORLD_MATRIX || scope === Object3DNode.VIEW_MATRIX) {\n      this._uniformNode.nodeType = 'mat4';\n    } else if (scope === Object3DNode.NORMAL_MATRIX) {\n      this._uniformNode.nodeType = 'mat3';\n    } else if (scope === Object3DNode.POSITION || scope === Object3DNode.VIEW_POSITION || scope === Object3DNode.DIRECTION || scope === Object3DNode.SCALE) {\n      this._uniformNode.nodeType = 'vec3';\n    }\n    return this._uniformNode.build(builder);\n  }\n  serialize(data) {\n    super.serialize(data);\n    data.scope = this.scope;\n  }\n  deserialize(data) {\n    super.deserialize(data);\n    this.scope = data.scope;\n  }\n}\nObject3DNode.VIEW_MATRIX = 'viewMatrix';\nObject3DNode.NORMAL_MATRIX = 'normalMatrix';\nObject3DNode.WORLD_MATRIX = 'worldMatrix';\nObject3DNode.POSITION = 'position';\nObject3DNode.SCALE = 'scale';\nObject3DNode.VIEW_POSITION = 'viewPosition';\nObject3DNode.DIRECTION = 'direction';\nexport default Object3DNode;\nexport const objectDirection = nodeProxy(Object3DNode, Object3DNode.DIRECTION);\nexport const objectViewMatrix = nodeProxy(Object3DNode, Object3DNode.VIEW_MATRIX);\nexport const objectNormalMatrix = nodeProxy(Object3DNode, Object3DNode.NORMAL_MATRIX);\nexport const objectWorldMatrix = nodeProxy(Object3DNode, Object3DNode.WORLD_MATRIX);\nexport const objectPosition = nodeProxy(Object3DNode, Object3DNode.POSITION);\nexport const objectScale = nodeProxy(Object3DNode, Object3DNode.SCALE);\nexport const objectViewPosition = nodeProxy(Object3DNode, Object3DNode.VIEW_POSITION);\naddNodeClass('Object3DNode', Object3DNode);","map":{"version":3,"names":["Node","addNodeClass","NodeUpdateType","UniformNode","nodeProxy","Vector3","Object3DNode","constructor","scope","arguments","length","undefined","VIEW_MATRIX","object3d","updateType","OBJECT","_uniformNode","getNodeType","WORLD_MATRIX","NORMAL_MATRIX","POSITION","VIEW_POSITION","DIRECTION","SCALE","update","frame","object","uniformNode","value","modelViewMatrix","normalMatrix","matrixWorld","setFromMatrixPosition","setFromMatrixScale","getWorldDirection","camera","applyMatrix4","matrixWorldInverse","generate","builder","nodeType","build","serialize","data","deserialize","objectDirection","objectViewMatrix","objectNormalMatrix","objectWorldMatrix","objectPosition","objectScale","objectViewPosition"],"sources":["/Users/vedant/node_modules/three/examples/jsm/nodes/accessors/Object3DNode.js"],"sourcesContent":["import Node, { addNodeClass } from '../core/Node.js';\nimport { NodeUpdateType } from '../core/constants.js';\nimport UniformNode from '../core/UniformNode.js';\nimport { nodeProxy } from '../shadernode/ShaderNode.js';\n\nimport { Vector3 } from 'three';\n\nclass Object3DNode extends Node {\n\n\tconstructor( scope = Object3DNode.VIEW_MATRIX, object3d = null ) {\n\n\t\tsuper();\n\n\t\tthis.scope = scope;\n\t\tthis.object3d = object3d;\n\n\t\tthis.updateType = NodeUpdateType.OBJECT;\n\n\t\tthis._uniformNode = new UniformNode( null );\n\n\t}\n\n\tgetNodeType() {\n\n\t\tconst scope = this.scope;\n\n\t\tif ( scope === Object3DNode.WORLD_MATRIX || scope === Object3DNode.VIEW_MATRIX ) {\n\n\t\t\treturn 'mat4';\n\n\t\t} else if ( scope === Object3DNode.NORMAL_MATRIX ) {\n\n\t\t\treturn 'mat3';\n\n\t\t} else if ( scope === Object3DNode.POSITION || scope === Object3DNode.VIEW_POSITION || scope === Object3DNode.DIRECTION || scope === Object3DNode.SCALE ) {\n\n\t\t\treturn 'vec3';\n\n\t\t}\n\n\t}\n\n\tupdate( frame ) {\n\n\t\tconst object = this.object3d;\n\t\tconst uniformNode = this._uniformNode;\n\t\tconst scope = this.scope;\n\n\t\tif ( scope === Object3DNode.VIEW_MATRIX ) {\n\n\t\t\tuniformNode.value = object.modelViewMatrix;\n\n\t\t} else if ( scope === Object3DNode.NORMAL_MATRIX ) {\n\n\t\t\tuniformNode.value = object.normalMatrix;\n\n\t\t} else if ( scope === Object3DNode.WORLD_MATRIX ) {\n\n\t\t\tuniformNode.value = object.matrixWorld;\n\n\t\t} else if ( scope === Object3DNode.POSITION ) {\n\n\t\t\tuniformNode.value = uniformNode.value || new Vector3();\n\n\t\t\tuniformNode.value.setFromMatrixPosition( object.matrixWorld );\n\n\t\t} else if ( scope === Object3DNode.SCALE ) {\n\n\t\t\tuniformNode.value = uniformNode.value || new Vector3();\n\n\t\t\tuniformNode.value.setFromMatrixScale( object.matrixWorld );\n\n\t\t} else if ( scope === Object3DNode.DIRECTION ) {\n\n\t\t\tuniformNode.value = uniformNode.value || new Vector3();\n\n\t\t\tobject.getWorldDirection( uniformNode.value );\n\n\t\t} else if ( scope === Object3DNode.VIEW_POSITION ) {\n\n\t\t\tconst camera = frame.camera;\n\n\t\t\tuniformNode.value = uniformNode.value || new Vector3();\n\t\t\tuniformNode.value.setFromMatrixPosition( object.matrixWorld );\n\n\t\t\tuniformNode.value.applyMatrix4( camera.matrixWorldInverse );\n\n\t\t}\n\n\t}\n\n\tgenerate( builder ) {\n\n\t\tconst scope = this.scope;\n\n\t\tif ( scope === Object3DNode.WORLD_MATRIX || scope === Object3DNode.VIEW_MATRIX ) {\n\n\t\t\tthis._uniformNode.nodeType = 'mat4';\n\n\t\t} else if ( scope === Object3DNode.NORMAL_MATRIX ) {\n\n\t\t\tthis._uniformNode.nodeType = 'mat3';\n\n\t\t} else if ( scope === Object3DNode.POSITION || scope === Object3DNode.VIEW_POSITION || scope === Object3DNode.DIRECTION || scope === Object3DNode.SCALE ) {\n\n\t\t\tthis._uniformNode.nodeType = 'vec3';\n\n\t\t}\n\n\t\treturn this._uniformNode.build( builder );\n\n\t}\n\n\tserialize( data ) {\n\n\t\tsuper.serialize( data );\n\n\t\tdata.scope = this.scope;\n\n\t}\n\n\tdeserialize( data ) {\n\n\t\tsuper.deserialize( data );\n\n\t\tthis.scope = data.scope;\n\n\t}\n\n}\n\nObject3DNode.VIEW_MATRIX = 'viewMatrix';\nObject3DNode.NORMAL_MATRIX = 'normalMatrix';\nObject3DNode.WORLD_MATRIX = 'worldMatrix';\nObject3DNode.POSITION = 'position';\nObject3DNode.SCALE = 'scale';\nObject3DNode.VIEW_POSITION = 'viewPosition';\nObject3DNode.DIRECTION = 'direction';\n\nexport default Object3DNode;\n\nexport const objectDirection = nodeProxy( Object3DNode, Object3DNode.DIRECTION );\nexport const objectViewMatrix = nodeProxy( Object3DNode, Object3DNode.VIEW_MATRIX );\nexport const objectNormalMatrix = nodeProxy( Object3DNode, Object3DNode.NORMAL_MATRIX );\nexport const objectWorldMatrix = nodeProxy( Object3DNode, Object3DNode.WORLD_MATRIX );\nexport const objectPosition = nodeProxy( Object3DNode, Object3DNode.POSITION );\nexport const objectScale = nodeProxy( Object3DNode, Object3DNode.SCALE );\nexport const objectViewPosition = nodeProxy( Object3DNode, Object3DNode.VIEW_POSITION );\n\naddNodeClass( 'Object3DNode', Object3DNode );\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}