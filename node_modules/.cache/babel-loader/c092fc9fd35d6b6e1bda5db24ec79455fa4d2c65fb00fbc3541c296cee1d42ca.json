{"ast":null,"code":"// https://github.com/cabbibo/glsl-tri-noise-3d\n\nimport { loop } from '../utils/LoopNode.js';\nimport { float, vec3, tslFn } from '../shadernode/ShaderNode.js';\nconst tri = tslFn(_ref => {\n  let [x] = _ref;\n  return x.fract().sub(.5).abs();\n});\nconst tri3 = tslFn(_ref2 => {\n  let [p] = _ref2;\n  return vec3(tri(p.z.add(tri(p.y.mul(1.)))), tri(p.z.add(tri(p.x.mul(1.)))), tri(p.y.add(tri(p.x.mul(1.)))));\n});\nconst triNoise3D = tslFn(_ref3 => {\n  let [p_immutable, spd, time] = _ref3;\n  const p = vec3(p_immutable).toVar();\n  const z = float(1.4).toVar();\n  const rz = float(0.0).toVar();\n  const bp = vec3(p).toVar();\n  loop({\n    start: float(0.0),\n    end: float(3.0),\n    type: 'float',\n    condition: '<='\n  }, () => {\n    const dg = vec3(tri3(bp.mul(2.0))).toVar();\n    p.addAssign(dg.add(time.mul(float(0.1).mul(spd))));\n    bp.mulAssign(1.8);\n    z.mulAssign(1.5);\n    p.mulAssign(1.2);\n    const t = float(tri(p.z.add(tri(p.x.add(tri(p.y)))))).toVar();\n    rz.addAssign(t.div(z));\n    bp.addAssign(0.14);\n  });\n  return rz;\n});\n\n// layouts\n\ntri.setLayout({\n  name: 'tri',\n  type: 'float',\n  inputs: [{\n    name: 'x',\n    type: 'float'\n  }]\n});\ntri3.setLayout({\n  name: 'tri3',\n  type: 'vec3',\n  inputs: [{\n    name: 'p',\n    type: 'vec3'\n  }]\n});\ntriNoise3D.setLayout({\n  name: 'triNoise3D',\n  type: 'float',\n  inputs: [{\n    name: 'p',\n    type: 'vec3'\n  }, {\n    name: 'spd',\n    type: 'float'\n  }, {\n    name: 'time',\n    type: 'float'\n  }]\n});\nexport { tri, tri3, triNoise3D };","map":{"version":3,"names":["loop","float","vec3","tslFn","tri","_ref","x","fract","sub","abs","tri3","_ref2","p","z","add","y","mul","triNoise3D","_ref3","p_immutable","spd","time","toVar","rz","bp","start","end","type","condition","dg","addAssign","mulAssign","t","div","setLayout","name","inputs"],"sources":["/Users/vedant/node_modules/three/examples/jsm/nodes/math/TriNoise3D.js"],"sourcesContent":["// https://github.com/cabbibo/glsl-tri-noise-3d\n\nimport { loop } from '../utils/LoopNode.js';\nimport { float, vec3, tslFn } from '../shadernode/ShaderNode.js';\n\nconst tri = tslFn( ( [ x ] ) => {\n\n\treturn x.fract().sub( .5 ).abs();\n\n} );\n\nconst tri3 = tslFn( ( [ p ] ) => {\n\n\treturn vec3( tri( p.z.add( tri( p.y.mul( 1. ) ) ) ), tri( p.z.add( tri( p.x.mul( 1. ) ) ) ), tri( p.y.add( tri( p.x.mul( 1. ) ) ) ) );\n\n} );\n\nconst triNoise3D = tslFn( ( [ p_immutable, spd, time ] ) => {\n\n\tconst p = vec3( p_immutable ).toVar();\n\tconst z = float( 1.4 ).toVar();\n\tconst rz = float( 0.0 ).toVar();\n\tconst bp = vec3( p ).toVar();\n\n\tloop( { start: float( 0.0 ), end: float( 3.0 ), type: 'float', condition: '<=' }, () => {\n\n\t\tconst dg = vec3( tri3( bp.mul( 2.0 ) ) ).toVar();\n\t\tp.addAssign( dg.add( time.mul( float( 0.1 ).mul( spd ) ) ) );\n\t\tbp.mulAssign( 1.8 );\n\t\tz.mulAssign( 1.5 );\n\t\tp.mulAssign( 1.2 );\n\n\t\tconst t = float( tri( p.z.add( tri( p.x.add( tri( p.y ) ) ) ) ) ).toVar();\n\t\trz.addAssign( t.div( z ) );\n\t\tbp.addAssign( 0.14 );\n\n\t} );\n\n\treturn rz;\n\n} );\n\n// layouts\n\ntri.setLayout( {\n\tname: 'tri',\n\ttype: 'float',\n\tinputs: [\n\t\t{ name: 'x', type: 'float' }\n\t]\n} );\n\ntri3.setLayout( {\n\tname: 'tri3',\n\ttype: 'vec3',\n\tinputs: [\n\t\t{ name: 'p', type: 'vec3' }\n\t]\n} );\n\ntriNoise3D.setLayout( {\n\tname: 'triNoise3D',\n\ttype: 'float',\n\tinputs: [\n\t\t{ name: 'p', type: 'vec3' },\n\t\t{ name: 'spd', type: 'float' },\n\t\t{ name: 'time', type: 'float' }\n\t]\n} );\n\nexport { tri, tri3, triNoise3D };\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}