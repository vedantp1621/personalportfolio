{"ast":null,"code":"import Node, { addNodeClass } from '../core/Node.js';\nimport { attribute } from '../core/AttributeNode.js';\nimport { varying } from '../core/VaryingNode.js';\nimport { normalize } from '../math/MathNode.js';\nimport { modelWorldMatrix, modelViewMatrix } from './ModelNode.js';\nimport { nodeImmutable } from '../shadernode/ShaderNode.js';\nclass PositionNode extends Node {\n  constructor() {\n    let scope = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : PositionNode.LOCAL;\n    super('vec3');\n    this.scope = scope;\n  }\n  isGlobal() {\n    return true;\n  }\n  getHash( /*builder*/\n  ) {\n    return `position-${this.scope}`;\n  }\n  generate(builder) {\n    const scope = this.scope;\n    let outputNode = null;\n    if (scope === PositionNode.GEOMETRY) {\n      outputNode = attribute('position', 'vec3');\n    } else if (scope === PositionNode.LOCAL) {\n      outputNode = varying(positionGeometry);\n    } else if (scope === PositionNode.WORLD) {\n      const vertexPositionNode = modelWorldMatrix.mul(positionLocal);\n      outputNode = varying(vertexPositionNode);\n    } else if (scope === PositionNode.VIEW) {\n      const vertexPositionNode = modelViewMatrix.mul(positionLocal);\n      outputNode = varying(vertexPositionNode);\n    } else if (scope === PositionNode.VIEW_DIRECTION) {\n      const vertexPositionNode = positionView.negate();\n      outputNode = normalize(varying(vertexPositionNode));\n    } else if (scope === PositionNode.WORLD_DIRECTION) {\n      const vertexPositionNode = positionLocal.transformDirection(modelWorldMatrix);\n      outputNode = normalize(varying(vertexPositionNode));\n    }\n    return outputNode.build(builder, this.getNodeType(builder));\n  }\n  serialize(data) {\n    super.serialize(data);\n    data.scope = this.scope;\n  }\n  deserialize(data) {\n    super.deserialize(data);\n    this.scope = data.scope;\n  }\n}\nPositionNode.GEOMETRY = 'geometry';\nPositionNode.LOCAL = 'local';\nPositionNode.WORLD = 'world';\nPositionNode.WORLD_DIRECTION = 'worldDirection';\nPositionNode.VIEW = 'view';\nPositionNode.VIEW_DIRECTION = 'viewDirection';\nexport default PositionNode;\nexport const positionGeometry = nodeImmutable(PositionNode, PositionNode.GEOMETRY);\nexport const positionLocal = nodeImmutable(PositionNode, PositionNode.LOCAL).temp('Position');\nexport const positionWorld = nodeImmutable(PositionNode, PositionNode.WORLD);\nexport const positionWorldDirection = nodeImmutable(PositionNode, PositionNode.WORLD_DIRECTION);\nexport const positionView = nodeImmutable(PositionNode, PositionNode.VIEW);\nexport const positionViewDirection = nodeImmutable(PositionNode, PositionNode.VIEW_DIRECTION);\naddNodeClass('PositionNode', PositionNode);","map":{"version":3,"names":["Node","addNodeClass","attribute","varying","normalize","modelWorldMatrix","modelViewMatrix","nodeImmutable","PositionNode","constructor","scope","arguments","length","undefined","LOCAL","isGlobal","getHash","generate","builder","outputNode","GEOMETRY","positionGeometry","WORLD","vertexPositionNode","mul","positionLocal","VIEW","VIEW_DIRECTION","positionView","negate","WORLD_DIRECTION","transformDirection","build","getNodeType","serialize","data","deserialize","temp","positionWorld","positionWorldDirection","positionViewDirection"],"sources":["/Users/vedant/node_modules/three/examples/jsm/nodes/accessors/PositionNode.js"],"sourcesContent":["import Node, { addNodeClass } from '../core/Node.js';\nimport { attribute } from '../core/AttributeNode.js';\nimport { varying } from '../core/VaryingNode.js';\nimport { normalize } from '../math/MathNode.js';\nimport { modelWorldMatrix, modelViewMatrix } from './ModelNode.js';\nimport { nodeImmutable } from '../shadernode/ShaderNode.js';\n\nclass PositionNode extends Node {\n\n\tconstructor( scope = PositionNode.LOCAL ) {\n\n\t\tsuper( 'vec3' );\n\n\t\tthis.scope = scope;\n\n\t}\n\n\tisGlobal() {\n\n\t\treturn true;\n\n\t}\n\n\tgetHash( /*builder*/ ) {\n\n\t\treturn `position-${this.scope}`;\n\n\t}\n\n\tgenerate( builder ) {\n\n\t\tconst scope = this.scope;\n\n\t\tlet outputNode = null;\n\n\t\tif ( scope === PositionNode.GEOMETRY ) {\n\n\t\t\toutputNode = attribute( 'position', 'vec3' );\n\n\t\t} else if ( scope === PositionNode.LOCAL ) {\n\n\t\t\toutputNode = varying( positionGeometry );\n\n\t\t} else if ( scope === PositionNode.WORLD ) {\n\n\t\t\tconst vertexPositionNode = modelWorldMatrix.mul( positionLocal );\n\t\t\toutputNode = varying( vertexPositionNode );\n\n\t\t} else if ( scope === PositionNode.VIEW ) {\n\n\t\t\tconst vertexPositionNode = modelViewMatrix.mul( positionLocal );\n\t\t\toutputNode = varying( vertexPositionNode );\n\n\t\t} else if ( scope === PositionNode.VIEW_DIRECTION ) {\n\n\t\t\tconst vertexPositionNode = positionView.negate();\n\t\t\toutputNode = normalize( varying( vertexPositionNode ) );\n\n\t\t} else if ( scope === PositionNode.WORLD_DIRECTION ) {\n\n\t\t\tconst vertexPositionNode = positionLocal.transformDirection( modelWorldMatrix );\n\t\t\toutputNode = normalize( varying( vertexPositionNode ) );\n\n\t\t}\n\n\t\treturn outputNode.build( builder, this.getNodeType( builder ) );\n\n\t}\n\n\tserialize( data ) {\n\n\t\tsuper.serialize( data );\n\n\t\tdata.scope = this.scope;\n\n\t}\n\n\tdeserialize( data ) {\n\n\t\tsuper.deserialize( data );\n\n\t\tthis.scope = data.scope;\n\n\t}\n\n}\n\nPositionNode.GEOMETRY = 'geometry';\nPositionNode.LOCAL = 'local';\nPositionNode.WORLD = 'world';\nPositionNode.WORLD_DIRECTION = 'worldDirection';\nPositionNode.VIEW = 'view';\nPositionNode.VIEW_DIRECTION = 'viewDirection';\n\nexport default PositionNode;\n\nexport const positionGeometry = nodeImmutable( PositionNode, PositionNode.GEOMETRY );\nexport const positionLocal = nodeImmutable( PositionNode, PositionNode.LOCAL ).temp( 'Position' );\nexport const positionWorld = nodeImmutable( PositionNode, PositionNode.WORLD );\nexport const positionWorldDirection = nodeImmutable( PositionNode, PositionNode.WORLD_DIRECTION );\nexport const positionView = nodeImmutable( PositionNode, PositionNode.VIEW );\nexport const positionViewDirection = nodeImmutable( PositionNode, PositionNode.VIEW_DIRECTION );\n\naddNodeClass( 'PositionNode', PositionNode );\n"],"mappings":"AAAA,OAAOA,IAAI,IAAIC,YAAY,QAAQ,iBAAiB;AACpD,SAASC,SAAS,QAAQ,0BAA0B;AACpD,SAASC,OAAO,QAAQ,wBAAwB;AAChD,SAASC,SAAS,QAAQ,qBAAqB;AAC/C,SAASC,gBAAgB,EAAEC,eAAe,QAAQ,gBAAgB;AAClE,SAASC,aAAa,QAAQ,6BAA6B;AAE3D,MAAMC,YAAY,SAASR,IAAI,CAAC;EAE/BS,WAAWA,CAAA,EAA+B;IAAA,IAA7BC,KAAK,GAAAC,SAAA,CAAAC,MAAA,QAAAD,SAAA,QAAAE,SAAA,GAAAF,SAAA,MAAGH,YAAY,CAACM,KAAK;IAEtC,KAAK,CAAE,MAAO,CAAC;IAEf,IAAI,CAACJ,KAAK,GAAGA,KAAK;EAEnB;EAEAK,QAAQA,CAAA,EAAG;IAEV,OAAO,IAAI;EAEZ;EAEAC,OAAOA,CAAA,CAAE;EAAA,EAAc;IAEtB,OAAQ,YAAW,IAAI,CAACN,KAAM,EAAC;EAEhC;EAEAO,QAAQA,CAAEC,OAAO,EAAG;IAEnB,MAAMR,KAAK,GAAG,IAAI,CAACA,KAAK;IAExB,IAAIS,UAAU,GAAG,IAAI;IAErB,IAAKT,KAAK,KAAKF,YAAY,CAACY,QAAQ,EAAG;MAEtCD,UAAU,GAAGjB,SAAS,CAAE,UAAU,EAAE,MAAO,CAAC;IAE7C,CAAC,MAAM,IAAKQ,KAAK,KAAKF,YAAY,CAACM,KAAK,EAAG;MAE1CK,UAAU,GAAGhB,OAAO,CAAEkB,gBAAiB,CAAC;IAEzC,CAAC,MAAM,IAAKX,KAAK,KAAKF,YAAY,CAACc,KAAK,EAAG;MAE1C,MAAMC,kBAAkB,GAAGlB,gBAAgB,CAACmB,GAAG,CAAEC,aAAc,CAAC;MAChEN,UAAU,GAAGhB,OAAO,CAAEoB,kBAAmB,CAAC;IAE3C,CAAC,MAAM,IAAKb,KAAK,KAAKF,YAAY,CAACkB,IAAI,EAAG;MAEzC,MAAMH,kBAAkB,GAAGjB,eAAe,CAACkB,GAAG,CAAEC,aAAc,CAAC;MAC/DN,UAAU,GAAGhB,OAAO,CAAEoB,kBAAmB,CAAC;IAE3C,CAAC,MAAM,IAAKb,KAAK,KAAKF,YAAY,CAACmB,cAAc,EAAG;MAEnD,MAAMJ,kBAAkB,GAAGK,YAAY,CAACC,MAAM,CAAC,CAAC;MAChDV,UAAU,GAAGf,SAAS,CAAED,OAAO,CAAEoB,kBAAmB,CAAE,CAAC;IAExD,CAAC,MAAM,IAAKb,KAAK,KAAKF,YAAY,CAACsB,eAAe,EAAG;MAEpD,MAAMP,kBAAkB,GAAGE,aAAa,CAACM,kBAAkB,CAAE1B,gBAAiB,CAAC;MAC/Ec,UAAU,GAAGf,SAAS,CAAED,OAAO,CAAEoB,kBAAmB,CAAE,CAAC;IAExD;IAEA,OAAOJ,UAAU,CAACa,KAAK,CAAEd,OAAO,EAAE,IAAI,CAACe,WAAW,CAAEf,OAAQ,CAAE,CAAC;EAEhE;EAEAgB,SAASA,CAAEC,IAAI,EAAG;IAEjB,KAAK,CAACD,SAAS,CAAEC,IAAK,CAAC;IAEvBA,IAAI,CAACzB,KAAK,GAAG,IAAI,CAACA,KAAK;EAExB;EAEA0B,WAAWA,CAAED,IAAI,EAAG;IAEnB,KAAK,CAACC,WAAW,CAAED,IAAK,CAAC;IAEzB,IAAI,CAACzB,KAAK,GAAGyB,IAAI,CAACzB,KAAK;EAExB;AAED;AAEAF,YAAY,CAACY,QAAQ,GAAG,UAAU;AAClCZ,YAAY,CAACM,KAAK,GAAG,OAAO;AAC5BN,YAAY,CAACc,KAAK,GAAG,OAAO;AAC5Bd,YAAY,CAACsB,eAAe,GAAG,gBAAgB;AAC/CtB,YAAY,CAACkB,IAAI,GAAG,MAAM;AAC1BlB,YAAY,CAACmB,cAAc,GAAG,eAAe;AAE7C,eAAenB,YAAY;AAE3B,OAAO,MAAMa,gBAAgB,GAAGd,aAAa,CAAEC,YAAY,EAAEA,YAAY,CAACY,QAAS,CAAC;AACpF,OAAO,MAAMK,aAAa,GAAGlB,aAAa,CAAEC,YAAY,EAAEA,YAAY,CAACM,KAAM,CAAC,CAACuB,IAAI,CAAE,UAAW,CAAC;AACjG,OAAO,MAAMC,aAAa,GAAG/B,aAAa,CAAEC,YAAY,EAAEA,YAAY,CAACc,KAAM,CAAC;AAC9E,OAAO,MAAMiB,sBAAsB,GAAGhC,aAAa,CAAEC,YAAY,EAAEA,YAAY,CAACsB,eAAgB,CAAC;AACjG,OAAO,MAAMF,YAAY,GAAGrB,aAAa,CAAEC,YAAY,EAAEA,YAAY,CAACkB,IAAK,CAAC;AAC5E,OAAO,MAAMc,qBAAqB,GAAGjC,aAAa,CAAEC,YAAY,EAAEA,YAAY,CAACmB,cAAe,CAAC;AAE/F1B,YAAY,CAAE,cAAc,EAAEO,YAAa,CAAC"},"metadata":{},"sourceType":"module","externalDependencies":[]}