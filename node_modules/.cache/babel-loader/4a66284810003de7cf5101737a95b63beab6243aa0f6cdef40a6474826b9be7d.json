{"ast":null,"code":"import LightingModel from '../core/LightingModel.js';\nimport F_Schlick from './BSDF/F_Schlick.js';\nimport BRDF_Lambert from './BSDF/BRDF_Lambert.js';\nimport { diffuseColor } from '../core/PropertyNode.js';\nimport { transformedNormalView } from '../accessors/NormalNode.js';\nimport { materialSpecularStrength } from '../accessors/MaterialNode.js';\nimport { shininess, specularColor } from '../core/PropertyNode.js';\nimport { positionViewDirection } from '../accessors/PositionNode.js';\nimport { tslFn, float } from '../shadernode/ShaderNode.js';\nconst G_BlinnPhong_Implicit = () => float(0.25);\nconst D_BlinnPhong = tslFn(_ref => {\n  let {\n    dotNH\n  } = _ref;\n  return shininess.mul(0.5 / Math.PI).add(1.0).mul(dotNH.pow(shininess));\n});\nconst BRDF_BlinnPhong = tslFn(_ref2 => {\n  let {\n    lightDirection\n  } = _ref2;\n  const halfDir = lightDirection.add(positionViewDirection).normalize();\n  const dotNH = transformedNormalView.dot(halfDir).clamp();\n  const dotVH = positionViewDirection.dot(halfDir).clamp();\n  const F = F_Schlick({\n    f0: specularColor,\n    f90: 1.0,\n    dotVH\n  });\n  const G = G_BlinnPhong_Implicit();\n  const D = D_BlinnPhong({\n    dotNH\n  });\n  return F.mul(G).mul(D);\n});\nclass PhongLightingModel extends LightingModel {\n  constructor() {\n    let specular = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : true;\n    super();\n    this.specular = specular;\n  }\n  direct(_ref3) {\n    let {\n      lightDirection,\n      lightColor,\n      reflectedLight\n    } = _ref3;\n    const dotNL = transformedNormalView.dot(lightDirection).clamp();\n    const irradiance = dotNL.mul(lightColor);\n    reflectedLight.directDiffuse.addAssign(irradiance.mul(BRDF_Lambert({\n      diffuseColor: diffuseColor.rgb\n    })));\n    if (this.specular === true) {\n      reflectedLight.directSpecular.addAssign(irradiance.mul(BRDF_BlinnPhong({\n        lightDirection\n      })).mul(materialSpecularStrength));\n    }\n  }\n  indirectDiffuse(_ref4) {\n    let {\n      irradiance,\n      reflectedLight\n    } = _ref4;\n    reflectedLight.indirectDiffuse.addAssign(irradiance.mul(BRDF_Lambert({\n      diffuseColor\n    })));\n  }\n}\nexport default PhongLightingModel;","map":{"version":3,"names":["LightingModel","F_Schlick","BRDF_Lambert","diffuseColor","transformedNormalView","materialSpecularStrength","shininess","specularColor","positionViewDirection","tslFn","float","G_BlinnPhong_Implicit","D_BlinnPhong","_ref","dotNH","mul","Math","PI","add","pow","BRDF_BlinnPhong","_ref2","lightDirection","halfDir","normalize","dot","clamp","dotVH","F","f0","f90","G","D","PhongLightingModel","constructor","specular","arguments","length","undefined","direct","_ref3","lightColor","reflectedLight","dotNL","irradiance","directDiffuse","addAssign","rgb","directSpecular","indirectDiffuse","_ref4"],"sources":["/Users/vedant/node_modules/three/examples/jsm/nodes/functions/PhongLightingModel.js"],"sourcesContent":["import LightingModel from '../core/LightingModel.js';\nimport F_Schlick from './BSDF/F_Schlick.js';\nimport BRDF_Lambert from './BSDF/BRDF_Lambert.js';\nimport { diffuseColor } from '../core/PropertyNode.js';\nimport { transformedNormalView } from '../accessors/NormalNode.js';\nimport { materialSpecularStrength } from '../accessors/MaterialNode.js';\nimport { shininess, specularColor } from '../core/PropertyNode.js';\nimport { positionViewDirection } from '../accessors/PositionNode.js';\nimport { tslFn, float } from '../shadernode/ShaderNode.js';\n\nconst G_BlinnPhong_Implicit = () => float( 0.25 );\n\nconst D_BlinnPhong = tslFn( ( { dotNH } ) => {\n\n\treturn shininess.mul( 0.5 / Math.PI ).add( 1.0 ).mul( dotNH.pow( shininess ) );\n\n} );\n\nconst BRDF_BlinnPhong = tslFn( ( { lightDirection } ) => {\n\n\tconst halfDir = lightDirection.add( positionViewDirection ).normalize();\n\n\tconst dotNH = transformedNormalView.dot( halfDir ).clamp();\n\tconst dotVH = positionViewDirection.dot( halfDir ).clamp();\n\n\tconst F = F_Schlick( { f0: specularColor, f90: 1.0, dotVH } );\n\tconst G = G_BlinnPhong_Implicit();\n\tconst D = D_BlinnPhong( { dotNH } );\n\n\treturn F.mul( G ).mul( D );\n\n} );\n\nclass PhongLightingModel extends LightingModel {\n\n\tconstructor( specular = true ) {\n\n\t\tsuper();\n\n\t\tthis.specular = specular;\n\n\t}\n\n\tdirect( { lightDirection, lightColor, reflectedLight } ) {\n\n\t\tconst dotNL = transformedNormalView.dot( lightDirection ).clamp();\n\t\tconst irradiance = dotNL.mul( lightColor );\n\n\t\treflectedLight.directDiffuse.addAssign( irradiance.mul( BRDF_Lambert( { diffuseColor: diffuseColor.rgb } ) ) );\n\n\t\tif ( this.specular === true ) {\n\n\t\t\treflectedLight.directSpecular.addAssign( irradiance.mul( BRDF_BlinnPhong( { lightDirection } ) ).mul( materialSpecularStrength ) );\n\n\t\t}\n\n\t}\n\n\tindirectDiffuse( { irradiance, reflectedLight } ) {\n\n\t\treflectedLight.indirectDiffuse.addAssign( irradiance.mul( BRDF_Lambert( { diffuseColor } ) ) );\n\n\t}\n\n}\n\nexport default PhongLightingModel;\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}